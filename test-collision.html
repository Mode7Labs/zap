<!DOCTYPE html>
<html>
<head>
  <title>Collision Debug</title>
  <style>
    body { margin: 0; padding: 20px; font-family: monospace; }
    #app { width: 800px; height: 600px; border: 2px solid #333; }
    #log { margin-top: 20px; white-space: pre-wrap; font-size: 12px; max-height: 400px; overflow-y: auto; }
  </style>
</head>
<body>
  <div id="app"></div>
  <div id="log"></div>

  <script type="module">
    import { Game, Scene, Sprite } from './dist/index.mjs';

    const log = document.getElementById('log');
    function addLog(msg) {
      log.textContent += msg + '\n';
      log.scrollTop = log.scrollHeight;
    }

    const game = new Game({
      parent: '#app',
      backgroundColor: '#0f3460',
      width: 800,
      height: 600
    });

    const scene = new Scene();

    // Static paddle on the right
    const paddle = new Sprite({
      x: 700,
      y: 300,
      width: 20,
      height: 100,
      color: '#e94560',
      checkCollisions: true,
      static: true
    });
    scene.add(paddle);

    // Ball moving right
    const ball = new Sprite({
      x: 400,
      y: 300,
      width: 20,
      height: 20,
      radius: 10,
      color: '#f7f7f7',
      vx: 200,
      vy: 0,
      friction: 1,
      bounciness: 1,
      gravity: 0,
      checkCollisions: true
    });
    scene.add(ball);

    let frameCount = 0;
    let colliding = false;

    scene.on('update', () => {
      frameCount++;

      // Only log when approaching paddle or during collision
      if (ball.x > 650 && frameCount < 200) {
        addLog(`Frame ${frameCount}: ball.x=${ball.x.toFixed(2)}, vx=${ball.vx.toFixed(2)}`);
      }
    });

    ball.on('collisionenter', (e) => {
      colliding = true;
      addLog(`\n>>> COLLISION ENTER at frame ${frameCount}: ball.x=${ball.x.toFixed(2)}, vx=${ball.vx.toFixed(2)}`);
    });

    ball.on('collide', (e) => {
      // Only log first few ongoing collision events
      if (colliding && frameCount < 200) {
        addLog(`... still colliding frame ${frameCount}: ball.x=${ball.x.toFixed(2)}, vx=${ball.vx.toFixed(2)}`);
      }
    });

    ball.on('collisionexit', (e) => {
      colliding = false;
      addLog(`<<< COLLISION EXIT at frame ${frameCount}: ball.x=${ball.x.toFixed(2)}, vx=${ball.vx.toFixed(2)}\n`);
    });

    game.setScene(scene);
    game.start();

    addLog('Watching ball collision with paddle...');
    addLog(`Ball starts at x=${ball.x}, moving right at vx=${ball.vx}`);
    addLog(`Paddle at x=${paddle.x}, width=${paddle.width}`);
  </script>
</body>
</html>
