<!DOCTYPE html>
<html>
<head>
  <title>Test Collision Tags</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      background: #0f3460;
      font-family: monospace;
      color: white;
    }
  </style>
</head>
<body>
  <h2>Collision Tags Test</h2>
  <p>Drag the blue player into the yellow coins</p>
  <div id="app"></div>
  <div id="log"></div>

  <script type="module">
    import { Game, Scene, Sprite } from './dist/index.mjs';

    const game = new Game({
      parent: '#app',
      width: 400,
      height: 300,
      backgroundColor: '#0f3460'
    });

    const scene = new Scene();
    const log = document.getElementById('log');

    function addLog(msg) {
      log.innerHTML += msg + '<br>';
      console.log(msg);
    }

    const player = new Sprite({
      x: 100,
      y: 150,
      width: 40,
      height: 40,
      color: '#4fc3f7',
      radius: 20,
      interactive: true,
      checkCollisions: true
    });

    // Only collide with entities tagged 'coin'
    player.collisionTags = ['coin'];

    // Create coins
    for (let i = 0; i < 3; i++) {
      const coin = new Sprite({
        x: 200 + i * 70,
        y: 150,
        width: 30,
        height: 30,
        color: '#f39c12',
        radius: 15,
        checkCollisions: true
      });

      coin.addTag('coin');
      addLog(`Coin ${i} created with tags: ${coin.tags.join(', ')}`);
      scene.add(coin);
    }

    scene.add(player);

    addLog(`Player collisionTags: ${player.collisionTags.join(', ')}`);
    addLog(`Player checkCollisions: ${player.checkCollisions}`);

    // Collect coins
    player.on('collisionenter', (event) => {
      if (event.other.hasTag('coin')) {
        addLog('âœ“ Coin collected!');
        event.other.destroy();
      }
    });

    // Drag player
    player.on('drag', (event) => {
      player.x += event.delta.x;
      player.y += event.delta.y;
    });

    game.setScene(scene);
    game.start();
  </script>
</body>
</html>
